<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    class UserCard extends HTMLElement {
      static get observedAttributes() {
        return ["img", "name", "email", "buttonclick"];
      }
      constructor() {
        super();
        const template = document.createElement("template");
        template.innerHTML = `
        <img src="" class="img" />
        <div class="container">
          <p class="name">å§“å</p>
          <p class="email">é‚®ç®±</p>
          <button class="buttonclick">Follow</button>
          <br>
          <input type="text" class="input" value="1" />
        </div>
        <slot name="eat">æˆ‘å–œæ¬¢åƒï¼šè‚‰è‚‰</slot>
        <slot name="likes">æˆ‘çš„çˆ±å¥½æ˜¯ï¼šæ•²ä»£ç </slot>
        
        <style>
          :host {
            display: flex;
            align-items: center;
            width: 650px;
            height: 280px;
            background: #d4d4d4!important;
            border: 1px solid #d5d5d5;
            box-shadow: 1px 1px 5px rgba(0, 0, 0, 0.1);
            border-radius: 3px;
            overflow: hidden;
            padding: 10px;
            box-sizing: border-box;
            font-family: "Poppins", sans-serif;
          }
          .img {
            width: 200px;
            margin-right: 20px;
          }
        </style>
       `;
        // åˆ›å»ºå½±å­dom
        this.shadowDOM = this.attachShadow({ mode: "closed" });

        this.shadowDOM.appendChild(template.content.cloneNode(true));
      }
      // æ’å…¥domæ—¶
      connectedCallback() {
        this.shadowDOM.querySelector(".input").focus();
      }
      // å±æ€§æ›´æ–°ã€åˆ é™¤ã€å¢åŠ ; é¦–æ¬¡æ’å…¥domä¹Ÿä¼šè§¦å‘
      attributeChangedCallback(name, oldValue, newValue) {
        console.log(name, oldValue, newValue);
        this.updateAttr(name, newValue);
      }
      updateAttr(name, value) {
        var el = this.shadowDOM.querySelector(`.${name}`);
        if (name === "img") {
          el.setAttribute("src", value);
        } else if (name === "buttonclick") {
          el.onclick = new Function(value);
        } else {
          el.innerText = value;
        }
      }
      // æä¾›apiæŠŠå†…éƒ¨çš„å€¼ä¼ é€’å‡ºå»
      getInputValue() {
        return this.shadowDOM.querySelector(".input").value;
      }
    }
    window.customElements.define("user-card", UserCard);
  </script>
</body>

  <user-card
    id="user-card"
    img="https://gw.alicdn.com/imgextra/i3/O1CN01E9ABza1II30bzYSKS_!!6000000000869-2-tps-120-108.png"
    name="ç‹äº”3"
    email="110@qq.com"
    buttonclick="test()">
    <div slot="likes" class="likes">
      <h3>æˆ‘çš„çˆ±å¥½ï¼š</h3>
      <p>ğŸ€</p>
      <p>ğŸ£</p>
      <p>ğŸ¸</p>
    </div>
    <div slot="eat" class="eat">
      <h3>æˆ‘çˆ±åƒçš„ï¼š</h3>
      <p>ğŸŸ</p>
      <p>ğŸš</p>
      <p>ğŸ¦†</p>
    </div>
  </user-card>

  <button onclick="getUserCardInputValue()">
    è¯»å–user-cardçš„è¾“å…¥æ¡†çš„value
  </button>

  <script>
    function getUserCardInputValue() {
      var card3 = document.getElementById("user-card");
      alert(card3.getInputValue());
    }

    function test() {
      alert("you followed me!");
    }
  </script>
</html>